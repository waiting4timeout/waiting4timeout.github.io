<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SSH Quick Actions</title><style>:root{color-scheme:dark;--bg:#0b0f14;--panel:#131a22;--border:#273445;--text:#e6edf3;--muted:#9fb2c8;--accent:#4da3ff;--danger:#ff6b6b;--header-height:72px;--input-height:56px;--quick-height:56px}*{box-sizing:border-box}body{margin:0;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;color:var(--text);background:var(--bg);height:100vh;display:flex;flex-direction:column}header{display:flex;gap:12px;align-items:center;padding:12px 16px;background:var(--panel);border-bottom:1px solid var(--border);position:fixed;top:0;left:0;right:0;z-index:10}header label{display:flex;flex-direction:column;gap:4px;font-size:12px;color:var(--muted)}header label.remember-field{flex:0 0 auto;width:auto;white-space:nowrap}header label.inline{flex-direction:row;align-items:center;gap:8px;padding-top:16px}header input[type=checkbox]{width:16px;height:16px;min-width:20px}header input{padding:8px 10px;border-radius:6px;border:1px solid var(--border);background:#0f141b;color:var(--text);min-width:160px}header button{padding:9px 16px;border-radius:6px;border:none;background:var(--accent);color:#07121c;font-weight:600;cursor:pointer}header button:disabled{opacity:.6;cursor:not-allowed}#status{margin-left:auto;font-size:12px;color:var(--muted)}main{flex:1;display:flex;flex-direction:column;padding:var(--header-height) 0 calc(var(--input-height) + var(--quick-height))}#terminal{flex:1;padding:16px;overflow:auto;white-space:pre-wrap;background:radial-gradient(circle at top,#0c1219 0,#0b0f14 60%);font-size:var(--terminal-font-size, 14px)}#terminal-font-controls{position:fixed;right:16px;bottom:calc(var(--input-height) + var(--quick-height) + 12px);display:flex;gap:8px;z-index:11}.font-btn{width:32px;height:32px;border-radius:999px;border:1px solid var(--border);background:var(--panel);color:var(--text);cursor:pointer;font-size:16px;line-height:1}.font-btn:disabled{opacity:.6;cursor:not-allowed}#quick-actions-row{display:flex;gap:8px;padding:8px 16px;border-top:1px solid var(--border);background:var(--panel);position:fixed;left:0;right:0;bottom:var(--input-height);z-index:10}.quick-action-btn{padding:8px 12px;border-radius:6px;border:1px solid var(--border);background:#0f141b;color:var(--text);cursor:pointer}.quick-action-btn:disabled{opacity:.6;cursor:not-allowed}#input-row{display:flex;gap:8px;padding:12px 16px;border-top:1px solid var(--border);background:var(--panel);position:fixed;left:0;right:0;bottom:0;z-index:10}.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:20}.modal.hidden{display:none}.modal-content{background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:16px;width:min(360px,90vw);box-shadow:0 12px 40px rgba(0,0,0,.5)}.modal-message{margin-bottom:16px}.modal-actions{display:flex;justify-content:flex-end;gap:8px}#confirm-ok{background:var(--accent);border:none;color:#07121c;padding:8px 14px;border-radius:6px;cursor:pointer}#confirm-cancel{background:0 0;border:1px solid var(--border);color:var(--text);padding:8px 14px;border-radius:6px;cursor:pointer}#command-input{flex:1;padding:10px 12px;border-radius:6px;border:1px solid var(--border);background:#0f141b;color:var(--text)}#send-btn{padding:9px 16px;border-radius:6px;border:1px solid var(--border);background:0 0;color:var(--text);cursor:pointer}#send-btn:disabled{opacity:.6;cursor:not-allowed}@media (max-width:720px){header{flex-wrap:wrap;align-items:flex-start}header label{width:100%}header input{min-width:0;width:100%}header button{width:100%}#status{width:100%;margin-left:0}#quick-actions-row{flex-wrap:wrap}#input-row{flex-wrap:wrap}#command-input,#send-btn{width:100%}}.hint{color:var(--muted)}.error{color:var(--danger)}</style></head><body><header><label>Server IP <input id="host" placeholder="192.168.0.10"></label> <label>User <input id="username" placeholder="user"></label> <label>Password <input id="password" type="password" placeholder="••••••••"></label> <button id="connect-btn" type="button">Connect</button> <label class="inline remember-field"><input id="remember" type="checkbox"> Remember me</label> <span id="status">Disconnected</span></header><main><div id="terminal" aria-live="polite"><span class="hint">This page needs a local WebSocket bridge to perform SSH. Start a backend that accepts a WebSocket connection and forwards data to SSH. Connect uses ws://localhost:8080/ssh by default.</span></div><div id="terminal-font-controls"><button id="font-decrease" class="font-btn" type="button">-</button> <button id="font-increase" class="font-btn" type="button">+</button></div><div id="quick-actions-row"><button id="quick-ctrlc" class="quick-action-btn" type="button" disabled="disabled">Ctrl+C</button> <button id="quick-sensors" class="quick-action-btn" type="button" disabled="disabled">Sensors</button> <button id="quick-ports" class="quick-action-btn" type="button" disabled="disabled">Ports</button> <button id="quick-reboot" class="quick-action-btn" type="button" disabled="disabled">Reboot</button> <button id="quick-shutdown" class="quick-action-btn" type="button" disabled="disabled">Shutdown</button></div><div id="input-row"><input id="command-input" placeholder="Type a command and press Enter" disabled="disabled"> <button id="send-btn" type="button" disabled="disabled">Send</button></div></main><div id="confirm-modal" class="modal hidden" role="dialog" aria-modal="true"><div class="modal-content"><div id="confirm-message" class="modal-message"></div><div class="modal-actions"><button id="confirm-cancel" type="button">Cancel</button> <button id="confirm-ok" type="button">Confirm</button></div></div></div><script>const e=document.getElementById("host"),t=document.getElementById("username"),n=document.getElementById("password"),d=document.getElementById("remember"),o=document.getElementById("connect-btn"),s=document.getElementById("terminal"),r=document.getElementById("status"),c=document.getElementById("command-input"),a=document.getElementById("send-btn"),i=document.getElementById("quick-ctrlc"),l=document.getElementById("quick-sensors"),m=document.getElementById("quick-ports"),u=document.getElementById("quick-reboot"),g=document.getElementById("quick-shutdown"),E=document.getElementById("confirm-modal"),v=document.getElementById("confirm-message"),h=document.getElementById("confirm-ok"),y=document.getElementById("confirm-cancel"),p=document.getElementById("font-decrease"),b=document.getElementById("font-increase");let I=null,k=null,L=null;const f="sshQuickActions.savedFields",w="sshQuickActions.terminalFontSize",B=10,S=22,C=(e,t)=>{const n=[...e],d=Math.max(0,n.length-2);return n.map((e,n)=>n<d?String.fromCharCode(e.charCodeAt(0)+t):e).join("")},q=e=>{const t=JSON.stringify(e),n=btoa(t);return C(n,-1)},x=e=>{const t=C(e,1),n=atob(t);return JSON.parse(n)},P=e=>e.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,""),$=()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"auto"})},H=(e,t)=>{const n=document.createElement("div");n.textContent=P(e),t&&n.classList.add(t),s.appendChild(n),requestAnimationFrame($)},z=d=>{r.textContent=d?"Connected":"Disconnected",o.textContent=d?"Disconnect":"Connect",c.disabled=!d,a.disabled=!d,i.disabled=!d,l.disabled=!d,m.disabled=!d,u.disabled=!d,g.disabled=!d,e.disabled=d,t.disabled=d,n.disabled=d},A=()=>{const o=e.value.trim()&&t.value.trim()&&n.value;d.disabled=!o,o||(d.checked=!1,O())},N=()=>{if(!d.checked)return;const o={host:e.value.trim(),username:t.value.trim(),password:n.value,remember:!0},s=q(o);localStorage.setItem(f,s)},F=()=>{const o=localStorage.getItem(f);if(o)try{const s=x(o);if(!s||!s.remember)return;e.value=s.host||"",t.value=s.username||"",n.value=s.password||"",d.checked=!0}catch(e){localStorage.removeItem(f)}},O=()=>{localStorage.removeItem(f)},J=()=>{const e=document.querySelector("header")?.offsetHeight||72,t=document.getElementById("input-row")?.offsetHeight||56,n=document.getElementById("quick-actions-row")?.offsetHeight||56;document.documentElement.style.setProperty("--header-height",`${e}px`),document.documentElement.style.setProperty("--input-height",`${t}px`),document.documentElement.style.setProperty("--quick-height",`${n}px`)},M=(e,t)=>{L=t,v.textContent=e,E.classList.remove("hidden")},R=()=>{L=null,E.classList.add("hidden")},D=()=>{const n=e.value.trim(),d=new URL(`ws://${n}:8080/ssh`);return d.searchParams.set("host",n),d.searchParams.set("username",t.value.trim()),d.toString()},Q=()=>{const d=e.value.trim(),o=t.value.trim(),s=n.value;if(!d||!o||!s)return void H("Host, username, and password are required.","error");N();const r=D();H(`Connecting to ${d} as ${o}...`),I=new WebSocket(r),I.addEventListener("open",()=>{z(!0),k=s,I.send(JSON.stringify({type:"auth",host:d,username:o,password:s}))}),I.addEventListener("message",e=>{const t=P(e.data||"");k&&/sudo/i.test(t)&&/(password|contraseñ?a)/i.test(t)&&(T(k),k=null),H(e.data)}),I.addEventListener("close",()=>{H("Connection closed."),z(!1),I=null}),I.addEventListener("error",()=>{H("WebSocket error. Is the SSH bridge running?","error")})},V=()=>{I&&I.close(),k=null};o.addEventListener("click",()=>{I?V():Q()}),d.addEventListener("change",()=>{d.checked?N():O()}),[e,t,n].forEach(e=>{e.addEventListener("input",N),e.addEventListener("input",A)}),F(),A(),J(),window.addEventListener("resize",J);const W=e=>{const t=Math.min(S,Math.max(B,e));document.documentElement.style.setProperty("--terminal-font-size",`${t}px`),localStorage.setItem(w,String(t)),p.disabled=t<=B,b.disabled=t>=S},j=()=>{const e=Number(localStorage.getItem(w));Number.isFinite(e)&&e>0?W(e):W(14)};p.addEventListener("click",()=>{const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--terminal-font-size"),10);W(e-1)}),b.addEventListener("click",()=>{const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--terminal-font-size"),10);W(e+1)}),j();const T=e=>{e&&I&&I.send(e+"\n")},U=()=>{const e=c.value;T(e),c.value=""};a.addEventListener("click",U),c.addEventListener("keydown",e=>{"Enter"===e.key&&U()}),l.addEventListener("click",()=>{T("sensors")}),m.addEventListener("click",()=>{T("ss -lntp")}),i.addEventListener("click",()=>{I&&I.send(" ")}),u.addEventListener("click",()=>{M("Reboot the remote server now?",()=>{k=n.value,T("sudo reboot")})}),g.addEventListener("click",()=>{M("Shutdown the remote server now?",()=>{k=n.value,T("sudo shutdown -h now")})}),h.addEventListener("click",()=>{L&&L(),R()}),y.addEventListener("click",R),E.addEventListener("click",e=>{e.target===E&&R()})</script></body></html>
